% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scaPCoA.R
\name{scapcoa}
\alias{scapcoa}
\title{Supervised and Covariate-Adjusted Principal Coordinates Analysis (scaPCoA)}
\usage{
scapcoa(obj, lambda_ls, pcoa, nPC = 3, residualization = FALSE)
}
\arguments{
\item{obj}{A list containing:
\describe{
\item{A}{A data frame or matrix of covariates.}
\item{Y}{A numeric vector of outcome values.}
\item{X_tilde}{A numeric matrix of features (e.g., microbiome counts).}
}}

\item{lambda_ls}{A numeric vector of candidate lambda values for tuning.}

\item{pcoa}{Logical. If \code{TRUE}, use Bray-Curtis PCoA decomposition.
If \code{FALSE}, use centered log-ratio (CLR) transformation.}

\item{nPC}{Integer. Number of principal components to compute. Default is 3.}

\item{residualization}{Logical. If \code{TRUE}, use the scaPCoA-R variant
with residualized matrices. Default is \code{FALSE}.}
}
\value{
A list with:
\describe{
\item{PC.scores}{A matrix of principal coordinate scores.}
\item{v_hat}{A matrix of estimated eigenvectors.}
\item{best.lambda}{The optimal lambda selected by tuning.}
\item{eigen_values}{A numeric vector of eigenvalues.}
\item{scores.partial.cor}{A matrix of partial correlations between
PC scores and Y/A.}
}
}
\description{
Main function for performing scaPCoA or scaPCoA-R (with residualization).
Finds principal coordinates that maximize association with the outcome Y
while minimizing association with confounding covariates A.
}
