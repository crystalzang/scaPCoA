% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/partial_cor.R
\name{partial.cor}
\alias{partial.cor}
\title{Compute Partial Correlations Between PC Scores, Outcome, and Covariates}
\usage{
partial.cor(scores, A, Y)
}
\arguments{
\item{scores}{A numeric matrix of principal coordinate scores (rows = samples,
columns = principal coordinates).}

\item{A}{A numeric matrix of covariates. Column names are used to label
results.}

\item{Y}{A numeric vector of outcome values (binary or continuous).}
}
\value{
A list containing:
\describe{
\item{partial}{A list with:
\describe{
\item{estimates}{A matrix of partial correlations. Rows correspond to
each covariate and Y. Columns correspond to each PC.}
\item{statistics}{A matrix of t-statistics (currently not populated).}
\item{df}{Degrees of freedom for partial correlation tests
(\code{n - 2 - ncol(A)}).}
}
}
}
}
\description{
Estimates partial correlations between each principal coordinate score and
the outcome Y conditional on covariates A, and between each score and each
covariate conditional on Y. Automatically selects the appropriate correlation
measure based on variable types (continuous, binary, categorical).
}
\details{
The function constructs a mixed correlation matrix for each PC score using
the appropriate measure for each variable pair:
\describe{
\item{Continuous vs Continuous}{Pearson correlation}
\item{Binary vs Continuous}{Point-biserial correlation via
\code{\link[ltm]{biserial.cor}}}
\item{Binary vs Binary}{Matthews Correlation Coefficient via
\code{\link[mltools]{mcc}}}
\item{Categorical vs Continuous/Binary}{Eta squared via
\code{\link[rstatix]{anova_test}}}
}

Partial correlations are derived by inverting the correlation matrix. If the
matrix is nearly singular, the Moore-Penrose pseudoinverse is used via
\code{\link[MASS]{ginv}}.
}
