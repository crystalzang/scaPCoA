% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_data.R
\name{generate_data}
\alias{generate_data}
\title{Generate Simulated Microbiome Data with Confounders}
\usage{
generate_data(
  seed = 1,
  n = 100,
  p = 200,
  l = 3,
  cor_val = 0.4,
  y_type = "bin",
  w_theta = 1,
  w_perc = 0.5,
  coef_x = 0.5,
  coef_a = c(1, -1, 1),
  zinLDA_min = 1000,
  zinLDA_max = 30000
)
}
\arguments{
\item{seed}{Integer. Random seed for reproducibility.}

\item{n}{Integer. Number of samples. Default is 100.}

\item{p}{Integer. Number of features (taxa). Default is 200.}

\item{l}{Integer. Number of covariates. Default is 3.}

\item{cor_val}{Numeric. Correlation between continuous covariates A1 and A2.
Default is 0.4.}

\item{y_type}{Character. Type of outcome variable. Either \code{"bin"} for
binary or \code{"cont"} for continuous. Default is \code{"bin"}.}

\item{w_theta}{Numeric. Currently unused. Default is 1.}

\item{w_perc}{Numeric. Proportion of columns in X to randomly select.
Default is 0.5.}

\item{coef_x}{Numeric. Coefficient for signal features W in the outcome
model. Default is 0.5.}

\item{coef_a}{Numeric vector of length 3. Coefficients for A1, A3, and
A1*A2 interaction in the outcome model. Default is \code{c(1, -1, 1)}.}

\item{zinLDA_min}{Integer. Minimum sequencing depth per sample.
Default is 1000.}

\item{zinLDA_max}{Integer. Maximum sequencing depth per sample.
Default is 30000.}
}
\value{
A list with:
\describe{
\item{A}{A data frame of covariates (A1, A2, A3).}
\item{Y}{A vector of outcome values (binary or continuous).}
\item{W}{A matrix of signal features selected based on high correlations.}
\item{X_tilde}{The full feature matrix after filtering.}
\item{features_signals}{Column names of the signal features in W.}
}
}
\description{
Generates simulated microbiome count data using zero-inflated LDA,
along with correlated covariates and binary or continuous outcomes
for testing scaPCoA methods.
}
\details{
The data generation process:
\enumerate{
\item Covariates A1 and A2 are drawn from a bivariate normal with
correlation \code{cor_val}. A3 is binary (Bernoulli with p = 0.3).
\item Microbiome counts are simulated using \code{\link[zinLDA]{simulateZINLDA}}
with zero inflation.
\item 15 signal features (W) are selected based on high pairwise
Pearson correlations among relative abundances.
\item The outcome Y is generated from a linear predictor involving W and
the covariates, using a logistic link for binary outcomes.
}
}
\examples{
\dontrun{
dat <- generate_data(seed = 1, n = 100, p = 200, zinLDA_min = 1000, zinLDA_max = 10000)
str(dat)
}
}
