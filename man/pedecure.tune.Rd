% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scaPCoA.R
\name{pedecure.tune}
\alias{pedecure.tune}
\title{Tune Lambda for PeDecURe}
\usage{
pedecure.tune(
  X.orig,
  X.max,
  X.penalize,
  lambdas,
  A,
  Y,
  nPC,
  centerX = F,
  scaleX = F,
  centerY = F,
  scaleY = F,
  centerA = F,
  scaleA = F,
  n.cores = 1,
  plot = FALSE,
  thresh = 0.001
)
}
\arguments{
\item{X.orig}{A numeric matrix of original features.}

\item{X.max}{A numeric matrix used for the maximization term.}

\item{X.penalize}{A numeric matrix used for the penalization term.}

\item{lambdas}{A numeric vector of candidate lambda values to evaluate.}

\item{A}{A numeric matrix of covariates.}

\item{Y}{A numeric vector or matrix of outcome values.}

\item{nPC}{Integer. Number of principal components to compute.}

\item{centerX}{Logical. Whether to center X. Default is \code{FALSE}.}

\item{scaleX}{Logical. Whether to scale X. Default is \code{FALSE}.}

\item{centerY}{Logical. Whether to center Y. Default is \code{FALSE}.}

\item{scaleY}{Logical. Whether to scale Y. Default is \code{FALSE}.}

\item{centerA}{Logical. Whether to center A. Default is \code{FALSE}.}

\item{scaleA}{Logical. Whether to scale A. Default is \code{FALSE}.}

\item{n.cores}{Integer. Number of cores for parallel computation.
Default is 1.}

\item{plot}{Logical. Currently unused. Default is \code{FALSE}.}

\item{thresh}{Numeric. Currently unused. Default is 0.001.}
}
\value{
A list with:
\describe{
\item{weighted_sum_abs_diff}{Numeric vector of tuning criterion values
for each valid lambda.}
\item{lambdas}{The candidate lambda values evaluated.}
\item{lambda_tune}{The optimal lambda that maximizes the tuning
criterion. \code{NA} if no valid lambda was found.}
}
}
\description{
Selects the optimal penalization parameter lambda by maximizing the
eigenvalue-weighted difference between partial correlations with the
outcome Y and partial correlations with covariates A.
}
\details{
For each candidate lambda, the function runs \code{\link{pedecure}},
computes in-sample PC scores, and evaluates partial correlations via
\code{\link{partial.cor}}. The tuning criterion is the mean across
covariates of the eigenvalue-weighted difference:
\code{|pcor(Y, PC)| - |pcor(A, PC)|}.
}
